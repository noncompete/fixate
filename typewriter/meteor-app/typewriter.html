<head>
  <title>Typewriter for Kindle</title>
</head>

<body>
  <div id="synced-display">{{{text.text}}}</div>
  <div id="text-editor" contenteditable="true"></div>
  <button id="sync-button"></button>
  <script>

    function preparePage() {
      if (document.URL.indexOf("editor") == -1) {
        return;
      }

      document.getElementById("synced-display").style.display = "none";

      document.getElementById("text-editor").innerHTML = document.getElementById("synced-display").innerHTML;

      document.getElementById("text-editor").style.display = "block";
    }

    document.getElementById("text-editor").onkeyup = function () {
      document.getElementById("sync-button").click();
    }

    document.getElementById("text-editor").onmouseup = function () {
        document.getElementById("sync-button").click();
    }

    setTimeout(preparePage, 3000);

  </script>
</body>